# プランニングドキュメント：Windows版 FlowCut GUI パッケージ化（初期版）

**作成日**: 2025-12-03  
**バージョン**: 1.0  
**ステータス**: ドラフト  
**前バージョンからの変更**: 初版作成（Windows版 GUI パッケージ化の方針を整理）

※初めて作業に取り掛かる場合は、必ずこのプランドキュメントと別にある要件定義書（`docs/requirement.md`）と runbook（`docs/runbook.md`）も確認してください。  
※Windows 向け配布方針は既存要件内で「別PLANで詳細設計」となっていたため、本ドキュメントで具体化します。

---

# 進捗状況

## ⚡ クイックリファレンス

> 新規エージェントが3分で状況を把握するためのサマリー

**現在地**: Phase 2 - Windows 用 PyInstaller 設定作成 & Whisper ローカル実行確認（FlowCut.exe で文字起こしまで動作確認済み）  
**次のアクション**: Whisper `assets` の同梱ステップを自動化する方針と ffmpeg 同梱方法を整理し、配布パッケージ（zip）手順を固める  
**ブロッカー**: Windows 向け ffmpeg バイナリの同梱方針と PyInstaller レシピへの反映がまだ未決（現状は Whisper 資産のみ暫定対応）  
**重要な決定事項**: Windows版は「Python本体・依存ライブラリ・ffmpeg を同梱」し、友人側で追加インストール無しで GUI を起動できる形を目標とする

### フェーズ進捗
- [x] Phase 0: 要件整理 & 現状コード調査（Mac版バンドル仕様の確認を含む）  
- [x] Phase 1: Windows 開発環境・実行環境の整備（公式 Python 3.10 + venv で CLI/GUI がネイティブに動く状態を確認）  
- [🔄] Phase 2: Windows 用 PyInstaller 設定作成 & 1st ビルド（one-folder 方式）  
- [ ] Phase 3: ffmpeg / Whisper ランタイム / 設定ファイルの同梱設計 & 実装  
- [ ] Phase 4: 配布パッケージ整備（zip or インストーラ） & 動作確認（友人想定の UX 検証）  
- [ ] Phase 5: ドキュメント更新（README / requirement / runbook / ユーザー向けガイド）

### 環境チェックリスト
- [ ] Windows 10/11 64bit 環境で開発・検証できるマシンがある  
- [ ] Python 3.10〜3.12 のいずれかが Windows でも利用可能（開発時）  
- [ ] `.env` に LLM/API キー（少なくとも `GOOGLE_API_KEY` or `OPENAI_API_KEY`）が設定済み  
- [ ] PyInstaller が Windows 環境にインストール済み（`pip install pyinstaller`）  
- [ ] ffmpeg の Windows バイナリ取得元（公式ビルドなど）が決まっている（※同梱用・TODO 詳細設計）

### 重要なファイルパス
- メインGUIランチャー: `flowcut_gui_launcher.py`  
- GUI本体: `src/gui/app.py` および `src/gui/**`  
- CLIエントリポイント: `src/cli/main.py`（`python -m src.cli.main gui`）  
- ワークフロー定義: `src/llm/workflows/**`  
- PyInstaller（macOS向け）設定: `FlowCut.spec`, `FlowCut GUI.spec`  
- 要件定義: `docs/requirement.md`  
- 開発者向けランブック: `docs/runbook.md`

---

## 🔄 現在の作業状態

**最終更新**: 2025-12-17 16:03 JST  
**進捗率**: 40%

### 直前の作業
- ✅ Windows 実機での開発環境構築（公式 Python 3.10 + venv）
  - 公式 Python 3.10 x64 を用いて `.venv` を作成し、`requirements-dev.txt` と `openai-whisper` をインストール  
  - `python -c "import torch, whisper; print('OK', torch.__version__)"` で Torch / Whisper が DLL エラーなく動作することを確認  
- ✅ FlowCut_win.spec の作成・調整と PyInstaller ビルド
  - `FlowCut_win.spec` を追加し、GUI ランチャー（`flowcut_gui_launcher.py`）と Windows 用アイコン（`assets/FlowCut.ico`）をエントリポイントとして設定  
  - PyInstaller で `dist/FlowCut/FlowCut.exe` を生成し、Whisper 実行時の DLL エラー（c10.dll）を解消  
- ✅ Whisper assets の同梱と GUI からの動作確認
  - `mel_filters.npz` / `multilingual.tiktoken` など Whisper の `assets` を `dist/FlowCut/_internal/whisper/assets/` にコピーする暫定手順を確立  
  - Windows 上で `FlowCut.exe` を起動し、数分の音声ファイルでローカル Whisper → LLM 整形 → SRT 出力まで一連の流れが動作することを確認  
- ✅ GUIのログ保存（ログ保存ON時に `{subtitle_dir}/{入力ファイル名(拡張子なし)}_{timestamp}/` を作成し、`{run_id}.srt` と `logs/` をまとめて保存）オプションと、メトリクス簡易サマリ表示を追加  
  - ログ保存ON時: `{subtitle_dir}/{入力ファイル名(拡張子なし)}_{timestamp}/logs/` 配下に `poc_samples/`, `progress/`, `metrics/`, `llm_raw/` をまとめて保存（デバッグ用）  
  - テスト追加で出力構造を担保
- ✅ GUIで、待機時間/実処理時間 と Pass1〜Pass4（＋Pass5は有効時のみ）の処理時間を表示
- ✅ 動画入力でもメトリクス内訳（Pass別トークン/コスト）を表示できるように修正
- ✅ workflow2 の Pass1 がモデル/コンテキスト都合で失敗した場合、Pass1だけ「workflow1側のモデル」で再試行（失敗時はエラー表示 + llm_rawに原因を保存）
- ✅ 出力欄に「開く」ボタンを追加し、出力フォルダを直接開けるように改善
- ✅ README にユーザー向けのアプリ説明を追加（`README.md` / `docs/README.md`）
- ✅ Pass5（長行改行）を追加（有効化したときのみ実行）
- ✅ ワークフロー定義を registry 化し、workflow3 を追加（ワークフロー単位で独立して変更可能・削除も安全）
- ⏳ 次のタスク: ffmpeg バイナリの同梱方針を決めたうえで、FlowCut_win.spec / runbook に反映し、配布パッケージ（zip）の手順を固める

### ブロッカー・未解決の問題
- [ ] ffmpeg の Windows バイナリをどのディレクトリ構成で同梱するか要検討（TODO: Phase 3 で設計）  
- [ ] Whisper モデル（large-v3）の扱い（初回ダウンロード前提か、事前同梱するか）をコストとサイズの観点で要検討  
- [ ] 現状 Whisper `assets` のコピーは手動コマンドで行っており、将来的には PyInstaller レシピ側で自動同梱できるように改善したい

### 最近の変更履歴（直近5件）
| 日時 | 変更内容 | 関連ファイル |
|------|---------|-------------|
| 12-17 16:03 | GUIの「ワークフロー」表示を「スロット」に整理（workflow1/2/3と混同しないため） | `src/gui/workflow_panel.py`, `src/gui/controller.py`, `src/gui/app.py`, `docs/README.md`, `src/cli/main.py`, `docs/plan/20251203_PLAN1.md` |
| 12-17 15:13 | workflow registry 化 + workflow3 追加（ワークフローごとにプロンプト/設定を分離） | `src/llm/workflows/**`, `src/llm/two_pass.py`, `src/pipeline/poc.py`, `src/gui/workflow_panel.py`, `src/gui/config.py`, `src/cli/main.py`, `tests/test_workflow_registry.py`, `docs/plan/20251203_PLAN1.md`, `docs/requirement.md` |
| 12-17 00:29 | workflow2失敗の原因可視化（APIエラーもllm_rawへ）+ Pass1モデルの自動フォールバック | `src/llm/two_pass.py`, `src/pipeline/poc.py`, `tests/test_workflow2_failure_diagnostics.py`, `docs/plan/20251203_PLAN1.md`, `docs/requirement.md` |
| 12-15 23:51 | ログ保存ON時の出力を `{subtitle_dir}/{入力ファイル名(拡張子なし)}_{timestamp}/` にまとめる（SRT + logs/） | `src/pipeline/poc.py`, `src/gui/controller.py`, `tests/test_output_logs_structure.py`, `docs/requirement.md` |
| 12-15 23:33 | README にユーザー向けのアプリ説明を追加 | `README.md`, `docs/README.md` |

---

## 開発引き継ぎ詳細

### 📌 承認内容（前提として合意済みとみなす項目）
- [x] 友人（非エンジニア）が Windows で「配布物を展開 → アイコンをダブルクリック」だけで使える状態を目指す  
- [x] Python や ffmpeg を友人に別途インストールさせない（パッケージ側で同梱する）  
- [x] 既存の Mac 版 GUI（`flowcut_gui_launcher.py` + `src/gui/app.py`）と同等の UX（APIキー入力 → 音声選択 → SRT 出力）を Windows 版でも再現する

※上記は不一致があれば後から修正し、履歴として残す。

### 🗂️ プロジェクト状態
- **技術スタック**:  
  - バックエンド: Python 3.10–3.12  
  - 音声認識: MLX Whisper / kotoba-whisper / openai-whisper（Windows 版では MLX は利用しない想定）  
  - LLM: Google Gemini / OpenAI / Anthropic（環境変数と CLI オプションで切替）  
  - GUI: Tkinter（`flowcut_gui_launcher.py` → `src/gui/app.py`）
- **動作確認済み機能（macOS / Windows）**:  
  - macOS: CLI からの文字起こし + two-pass 行分割 + SRT 出力、Tkinter GUI からの音声選択・実行・ステータス表示  
  - Windows: 公式 Python 3.10 + venv 上の CLI / GUI 実行、および PyInstaller で生成した `FlowCut.exe` によるローカル Whisper → LLM 整形 → SRT 出力  
- **既知の問題 / 注意点（Windows視点）**:  
  - ffmpeg バイナリの同梱方針が未決（現状は開発環境側の ffmpeg に依存している可能性がある）  
  - MLX Whisper は Metal 依存のため Windows では利用不可 → Windows 版は openai-whisper 等の別ランナー前提  
  - Whisper large-v3 モデルはサイズが大きく、完全同梱はパッケージサイズ増大のリスク（TODO: 方針確定）

### 🚀 実装優先順位

1. **Phase 0** - 要件整理 & 現状コード調査  
   - 理由: どこまでを Windows 版でカバーするか（モデル・LLM・オフライン要件など）を明確にしないと設計がぶれるため  
2. **Phase 1** - Windows 開発環境・実行環境の整備  
   - 理由: 実機で CLI/GUI を動かせないと PyInstaller のビルド・動作確認ができないため  
3. **Phase 2** - Windows 用 PyInstaller 設定作成 & 1st ビルド  
   - 理由: まずは「動く .exe（フォルダ同梱型）」を作り、依存関係の洗い出しを行う  
4. **Phase 3** - ffmpeg / Whisper ランタイム / 設定ファイルの同梱設計 & 実装  
5. **Phase 4** - 配布パッケージ整備 & 動作確認（友人視点の UX 検証）  
6. **Phase 5** - requirement / README / runbook / ユーザーガイドの更新

### ⚠️ 重要な注意事項

- **ビルド環境**: PyInstaller は基本的にターゲット OS 上でビルドする前提（Windows 向け .exe は Windows でビルド）  
- **モデルサイズ**: Whisper large-v3 を完全同梱するとパッケージが数GB級になる可能性が高い  
  - 初期バージョンでは「初回実行時に自動ダウンロード（キャッシュ）」とし、完全同梱は今後の検討とする案も有力  
- **APIキー管理**: Mac 版 GUI と同様に、Windows 版でも `~/.flowcut/config.json` 等に API キーを保存する設計を維持する（TODO: Windows のパス確認）  
- **友人向け UX**: エラー表示はできるだけ日本語で簡潔にし、「どうすればよいか」の次アクションを明示する

---

# 実装内容

## 💭 主要な意思決定（ドラフト）

> 実装方針の一貫性を保つための判断履歴（※未決のものは TODO として明示）

- **PyInstaller 継続採用**:  
  - Mac 版で既に `FlowCut.spec` / `FlowCut GUI.spec` を運用しており、GUI ランチャーも PyInstaller を前提とした実装になっているため  
- **Windows 版は one-folder 方式から開始**:  
  - 理由: one-file（単一 .exe）よりもデバッグしやすく、依存 DLL の扱いも把握しやすい  
  - 将来的に one-file 化やインストーラ化（NSIS / Inno Setup など）は別Phaseで検討  
- **Whisper モデルの扱い**:  
  - 初期版は openai-whisper による自動ダウンロード前提（パッケージ内にはライブラリのみ同梱）とし、完全同梱は TODO（コストとサイズを見て判断）  
- **GUI エントリポイント統一**:  
  - Mac / Windows ともに `flowcut_gui_launcher.py` を PyInstaller のエントリポイントとし、内部で `src.gui.app.run_gui` を呼び出す形を維持

---

## 📋 目次

1. [要件概要](#要件概要)  
2. [技術選定](#技術選定)  
3. [データベース設計](#データベース設計)（なし）  
4. [アーキテクチャ設計](#アーキテクチャ設計)  
5. [実装フェーズ](#実装フェーズ)  
6. [リスクと対応策](#リスクと対応策)  
7. [完了条件](#完了条件)  
8. [トラブルシューティング・既知の問題](#-トラブルシューティング既知の問題)  
9. [参考リソース](#参考リソース)

---

## 要件概要

### 背景・目的

現状の FlowCut は macOS 向けに `.app` パッケージ化を進めているが、  
友人（非エンジニア）が Windows PC からも同様の UX で FlowCut を利用できるようにする必要がある。  
特に、友人側で Python / ffmpeg / 各種ライブラリを手動インストールさせるのではなく、  
「配布物を展開 → アイコンをダブルクリック → API キーを入れて実行」という流れを目標とする。

### 実装する機能

- **Windows 向け GUI 実行バイナリの提供**  
  - `FlowCut.exe`（仮称）を配布し、ダブルクリックで Tkinter GUI を起動できる状態にする  
- **依存ライブラリの同梱**  
  - Python ランタイム / ライブラリ（typer, requests, openai-whisper など）を PyInstaller でまとめる  
- **ffmpeg の同梱**  
  - 音声入力変換に必要な ffmpeg バイナリをパッケージ内に含め、PATH を自動調整する  
- **Whisper 実行の Windows 対応**  
  - MLX 依存を避け、openai-whisper など Windows 対応のランナーで文字起こしを実行できるようにする（既存ランナーの活用）  
- **設定・ログ・出力ディレクトリの扱い統一**  
  - Windows でも Mac と同様に `~/.flowcut/config.json` や `logs/`, `output/` ディレクトリを使用しつつ、相対パスの起点を適切に調整する

### スコープ外

- 完全オフライン（LLM/API を一切使わない）での動作保証  
- Windows 用の高度なインストーラ（NSIS / Inno Setup など）の詳細設計  
  - 初期版は zip 配布 + one-folder PyInstaller 出力を前提とし、インストーラ対応は TODO とする  
- 新しい GUI 機能の追加（本PLANでは既存 GUI の移植・パッケージ化に集中）

---

## 技術選定

### 新規導入ライブラリ（予定）

現時点では **新規ライブラリの導入は必須ではない想定**。  
Windows 版インストーラ（NSIS / Inno Setup 等）を導入する場合は、別Phaseで選定する。

| ライブラリ | バージョン | 選定理由 |
|-----------|-----------|---------|
| （TODO）NSIS / Inno Setup など | 未定 | 将来、インストーラ形式にする場合に検討 |

### 既存ライブラリの活用

- `PyInstaller` : 既に Mac 向け `.app` 作成に利用中。Windows 版でも同じビルドパイプラインを流用。  
- `openai-whisper` : Windows で Whisper large-v3 を動かすためのランタイム（ローカル実行前提）。  
- `tkinter` : GUI フレームワークとして既に採用済み。Windows でも標準で利用可能。  
- `requests`, `typer`, `python-dotenv` : 既存 CLI / パイプラインで利用しているため、そのまま同梱。

---

## データベース設計

本プロジェクトはローカルファイルベースの処理であり、DB 変更は不要なため、このセクションは対象外。

---

## アーキテクチャ設計

### 1. ディレクトリ構造（Windows パッケージ関連の想定）

※ 既存構成に、Windows 向けビルド成果物ディレクトリを追加するイメージ。

```
project-root/
├── flowcut_gui_launcher.py       # PyInstaller エントリポイント
├── src/
│   ├── cli/main.py               # CLIエントリポイント（GUIからも内部的に利用）
│   ├── gui/                      # Tkinter GUI 一式
│   └── transcribe/               # Whisper ランナー群（mlx/openai 等）
├── config/                       # LLM・料金設定など
├── assets/                       # アイコン等（将来 Windows 用 .ico 追加も検討）
├── docs/
│   ├── requirement.md
│   ├── runbook.md
│   └── plan/20251203_PLAN1.md    # 本PLAN
├── dist/
│   └── win/                      # Windows 向けビルド成果物（例: FlowCut/ フォルダ）
└── FlowCut.spec                  # 既存 macOS 用（参考）
```

### 2. データフロー（Windows 版 GUI 実行時）

```
FlowCut.exe（PyInstaller出力）
        ↓
flowcut_gui_launcher.py
        ↓
src.gui.app.run_gui()
        ↓
ユーザー操作（音声ファイル選択・保存先指定・LLM設定）
        ↓
GuiController → CLI相当の処理（src.pipeline / src.transcribe / src.llm）
        ↓
Whisper ランナー（openai-whisper）で文字起こし
        ↓
two-pass 整形 → SRT 生成
        ↓
output/ 以下に .srt を保存
```

### 3. 主要コンポーネント（Windows パッケージ視点）

- **`flowcut_gui_launcher.py`**:  
  - 役割: PyInstaller から呼ばれる GUI ランチャー。`sys.frozen` 判定と PATH 調整、カレントディレクトリ調整を担当。  
- **`src/gui/app.py`** (`MainWindow`, `run_gui`) :  
  - 役割: Tkinter のメインウィンドウとワークフローパネルの構築。APIキー設定ダイアログもここで提供。  
- **`src/transcribe/*_runner.py`** :  
  - 役割: Whisper 実行の抽象化。Windows 版では主に openai ランナーを利用。  
- **PyInstaller spec（新規予定: `FlowCut_win.spec`）** :  
  - 役割: Windows 向けビルド設定（binaries, datas, hiddenimports, アイコン、出力フォルダ名など）を定義。

---

## 実装フェーズ

### Phase 0: 要件整理 & 現状コード調査（0.5日想定）

- [ ] `docs/requirement.md` の Windows セクションを再確認し、本PLANの内容と齟齬がないか確認  
- [ ] 既存 Mac 向け PyInstaller 設定（`FlowCut.spec`, `FlowCut GUI.spec`）で行っていることを洗い出す  
  - `datas`, `binaries`, `hiddenimports` の扱い  
  - ffmpeg の取り扱い（Mac では `/opt/homebrew/bin/ffmpeg` をバンドルしている）  
- [ ] Whisper ランナー（特に `src/transcribe/openai_runner.py` など）の Windows 対応状況を確認  
- [ ] Windows 版でサポートする機能範囲（モデル・LLM オプションなど）を決め、必要なら requirement に TODO コメントを追記

### Phase 1: Windows 開発環境・実行環境の整備（1日想定）

- [ ] Windows マシン上でリポジトリをクローンし、Python 仮想環境を作成  
  - `python -m venv .venv` → 有効化 → `pip install -r requirements-dev.txt`  
- [ ] `.env` を `.env.example` から作成し、最低限の API キーを設定  
- [ ] CLI が Windows 上で動作することを確認  
  - `python -m src.cli.main models`  
  - サンプル音声で `run` コマンドを最低1回実行（Whisper ランナーは openai を優先）  
- [ ] GUI が Windows 上で起動することを確認  
  - `python -m src.cli.main gui` または `python flowcut_gui_launcher.py`  
- [ ] Windows 特有のパスや Tkinter の挙動で問題がないかメモ

**実装のポイント**:
- 開発環境では ffmpeg を OS 側にインストールしておき、まずは PATH 依存で動作確認する  
- 動作が確認できたあと、Phase 3 で「パッケージとしての同梱」に切り替える方針

### Phase 2: Windows 用 PyInstaller 設定作成 & 1st ビルド（1日想定）

- [ ] 新規に `FlowCut_win.spec`（名称仮）を作成し、Windows 向け設定を定義  
  - エントリポイント: `['flowcut_gui_launcher.py']`  
  - 出力名: `FlowCut` / `FlowCut.exe`  
  - `console=False`（GUI アプリとして起動）  
- [ ] datas / binaries / hiddenimports の最小構成でビルドを試す  
  - 開発初期段階では ffmpeg 同梱を一旦外し、Python ランタイム部分の動作確認に集中  
- [ ] `dist/FlowCut/FlowCut.exe`（または `dist/win/FlowCut/FlowCut.exe`）が起動することを確認  
  - Whisper ランナーが import できるか  
  - GUI が表示されるか  
- [ ] ビルド・実行手順を docs/runbook にメモ（ドラフトでOK）

### Phase 3: ffmpeg / Whisper ランタイム / 設定ファイルの同梱設計 & 実装（1〜2日想定）

- [ ] Windows 用 ffmpeg バイナリを取得し、PyInstaller の `binaries` に追加  
  - 例: `binaries = [('path/to/windows/ffmpeg.exe', '.') ]` のように配置  
- [ ] `flowcut_gui_launcher.py` 内の PATH 追加ロジックを、Windows でも同梱 ffmpeg が優先されるよう拡張（必要に応じて条件分岐）  
- [ ] Whisper モデルの扱い方針を固める  
  - 初期版: openai-whisper に任せ、初回実行時の自動ダウンロード前提とする  
  - ※ 完全同梱や事前ダウンロードスクリプトは今後の検討（TODO として requirement に明記）  
- [ ] 設定ファイル（`~/.flowcut/config.json`）の Windows パスを確認し、必要ならドキュメントに記載

### Phase 4: 配布パッケージ整備（zip or インストーラ） & 動作確認（1日想定）

- [ ] one-folder 出力（`dist/FlowCut/`）を zip 化し、配布用パッケージ（例: `FlowCut-win.zip`）を作成  
- [ ] 配布想定フローを確認  
  - 友人は `FlowCut-win.zip` を解凍 → `FlowCut/FlowCut.exe` をダブルクリック → GUI 起動  
- [ ] パッケージ内 README（簡易な手順書）を追加  
  - Windows 版での API キー設定方法  
  - 初回起動時に Whisper モデルダウンロードが走る可能性と、その所要時間の目安  
- [ ] 友人の利用シナリオに沿った動作確認  
  - サンプル音声1本を使い、「字幕ができるまで」の体験を確認  
- [ ] インストーラ方式（NSIS / Inno Setup）を採用する場合の TODO を洗い出し（このPLANでは実装しない）

### Phase 5: ドキュメント更新（0.5〜1日想定）

- [ ] `docs/requirement.md` の Windows セクションを更新  
  - 「別PLANで設計」から「Windows 版 FlowCut GUI パッケージ化（本PLAN）」に紐づく形へ  
  - Whisper モデルの扱い、インターネット必須であることを明記  
- [ ] `docs/runbook.md` に Windows 版のビルド・配布手順を追加  
- [ ] `docs/README.md`（ユーザー向けガイド）に Windows 版のインストール・起動手順を追記  
- [ ] 本PLAN（`docs/plan/20251203_PLAN1.md`）の「フェーズ進捗」「現在の作業状態」「完了条件」を最終状態に更新

---

## リスクと対応策

- **リスク1: パッケージサイズの肥大化**  
  - Whisper large-v3 モデルや ffmpeg を同梱すると数GB級になる可能性  
  - 対応: 初期版はモデルを自動ダウンロード前提とし、パッケージにはランタイムと ffmpeg のみを同梱。完全同梱は別Phaseで検討。  
- **リスク2: Windows 固有の DLL / 依存関係問題**  
  - PyInstaller ビルド後に DLL が不足し、起動時エラーになる可能性  
  - 対応: 一度最小構成でビルド → 起動ログから不足DLLを特定 → `binaries` / `datas` に追加し再ビルド。  
- **リスク3: GUI 起動エラー（tkinter / パス問題）**  
  - 相対パス起点やカレントディレクトリが macOS と異なり、config / logs / output が想定外の場所に作られる可能性  
  - 対応: `flowcut_gui_launcher.py` 内の `os.chdir(root)` ロジックを確認し、Windows でも期待通りになるようテスト。  
- **リスク4: 友人環境でのみ再現するエラー**  
  - 例: セキュリティソフトによるブロック、権限不足など  
  - 対応: エラー発生時のメッセージ出力を分かりやすくし、サポート時にログを回収しやすいようにする。

---

## 完了条件

### 機能要件

- [ ] Windows 10/11 64bit 環境で、`FlowCut-win.zip` を解凍 → `FlowCut.exe` をダブルクリックすると GUI が起動する  
- [ ] GUI 上からサンプル音声ファイルを指定し、SRT ファイルが `output/` 以下に生成される  
- [ ] 友人が追加で Python / ffmpeg / ライブラリをインストールする必要がない  
- [ ] Whisper モデルの自動ダウンロード（初回のみ）が正常に完了し、その後の実行も安定している

### 品質要件

- [ ] 起動時・実行時の主要なエラーが日本語で簡潔に表示される  
- [ ] ビルドスクリプト（PyInstaller 実行コマンド）が再現性を持って動作する（CI への展開も視野に入れる）  
- [ ] Mac 版既存機能との挙動差異が仕様として説明できる範囲に収まっている  

### ドキュメント

- [ ] `docs/requirement.md` に Windows 版配布仕様が反映されている  
- [ ] `docs/runbook.md` に Windows 版ビルド・配布・トラブルシューティング手順が追記されている  
- [ ] `docs/README.md`（ユーザーガイド）に Windows 版のインストール・利用手順が追記されている  
- [ ] 本PLANのステータスが「完了」に更新されている

---

## 🐛 トラブルシューティング・既知の問題

### 注意ポイント1: Windows 向けビルドは Windows 環境必須

**問題**: macOS 上から PyInstaller で Windows .exe をビルドすることは基本的にできない。  
**対応**: Windows 実機（または Windows VM）上に開発環境を構築し、そこでビルドと動作確認を行う。  
**影響ファイル**: `FlowCut_win.spec`（予定）, `flowcut_gui_launcher.py`

### 注意ポイント2: 初回 Whisper モデルダウンロードの時間

**問題**: large-v3 モデルのダウンロードには時間がかかり、友人が「固まった」と誤解する可能性がある。  
**対応**: 初回起動時にはステータス欄等で「モデルをダウンロード中です（初回のみ数分かかる場合があります）」などのメッセージ表示を検討（TODO: GUI 改修が必要な場合は別PLAN化）。  
**影響ファイル**: `src/gui/**`, `src/transcribe/**`

---

## 参考リソース

### 公式ドキュメント

- PyInstaller: https://pyinstaller.org/  
- openai-whisper: https://github.com/openai/whisper  
- Python / Tkinter（標準ライブラリ）: https://docs.python.org/3/library/tkinter.html

### 関連プランドキュメント

- `docs/plan/20251127_PLAN1.md` : テロップ処理改善＆SRT ギャップ埋め PLAN（音声処理ロジック側の改善方針）  

---

**実装準備完了！🚀（本PLANに沿って、次は Phase 0 / Phase 1 のタスクを洗いながらブランチ作成・Draft PR 作成へ進む）**
