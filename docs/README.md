# FlowCut アプリご利用ガイド

## 1. FlowCut とは

FlowCut は、音声/動画ファイルを文字起こしし、
字幕ファイル（`.srt`）として保存できるデスクトップアプリです。

- 文字起こし: ローカルで Whisper を使用します
- 字幕の整形: 必要に応じて LLM（Google/OpenAI/Anthropic）を使用します

友人やクライアントに渡す動画の字幕作成などに利用できます。

---

## 2. インストール手順（macOS）

1. **`FlowCut.zip` を受け取る**  
   メールやクラウドストレージ経由で送られてきた `FlowCut.zip` をダウンロードします。

2. **解凍する**  
   `FlowCut.zip` をダブルクリックすると、`FlowCut.app` が作成されます。

3. **アプリを好きな場所へ移動**  
   `FlowCut.app` を次のような場所にドラッグ＆ドロップします。
   - `Applications` フォルダ
   - またはデスクトップなど、普段使う場所

4. **初回起動時の警告について**  
   macOS のセキュリティ設定により、初回起動時に「開発元を確認できません」等のダイアログが出る場合があります。

   その場合は次の手順で起動してください。

   1. `FlowCut.app` を **右クリック →「開く」** を選択
   2. 表示されたダイアログで **「開く」** を選択

   これで 2 回目以降は、通常どおりアイコンをダブルクリックするだけで起動できます。

---

## 2.5. インストール手順（Windows）

1. **`FlowCut-win.zip` を受け取る**  
   メールやクラウドストレージ経由で送られてきた `FlowCut-win.zip` をダウンロードします。

2. **解凍する**  
   `FlowCut-win.zip` を右クリック →「すべて展開…」で解凍します（任意の場所でOKです）。

3. **起動する**  
   解凍してできたフォルダの中の `FlowCut.exe` をダブルクリックで起動します。

4. **初回起動時の警告について（SmartScreen 等）**  
   初回に「Windows によって PC が保護されました」等が出る場合があります。  
   その場合は「詳細情報」→「実行」で起動してください。

---

## 3. 初回設定（LLM API キー）

FlowCut はローカルで Whisper による文字起こしを行い、字幕の整形に LLM API を使います。
そのため、**利用者ご自身の API キー** を入力する必要があります（Google / OpenAI / Anthropic のいずれか）。

1. `FlowCut.app` を起動します。
2. 画面右上の **「API設定」** ボタンをクリックします。
3. 表示されたダイアログの入力欄に、利用する **API キー** を貼り付けます。
4. **「保存」** ボタンを押します。

保存された API キーは、この Mac のみで使用され、
ホームディレクトリ以下の `~/.flowcut/config.json` に保存されます。開発者側には共有されません。

---

## 4. 音声文字起こしの使い方

### 4-1. 画面構成

	- **スロット 1**  
	  ここから実行します（同時実行はできません）。
	  ワークフローは `workflow2`（校正/最適化）で固定です。

	- **文字起こし（Whisper）**  
	  `mlx` / `whisper-local`（macOS）、`faster` / `whisper-local`（Windows）を選べます。

- **辞書（Glossary）**  
  固有名詞（人名・地名・組織名など）の正しい表記を登録できます（1行=1用語）。必要に応じて編集してください。

- **ファイルを選択**  
  文字起こししたい音声/動画ファイルを選びます。

- **保存先を変更**  
  出力される字幕ファイル（`.srt` など）の保存フォルダを変更できます。

- **出力（完了後）**  
  出力ファイル名が表示され、横の **「開く」** ボタンから出力フォルダを開けます。

	- **LLM オプション**  
	  通常は以下の設定のままで問題ありません。
	  - **詳細設定**: 必要なら Pass ごとの **モデル** を変更
	    - プロバイダー選択はありません（選んだモデルから自動で判定されます）
	    - Pass1 のモデルを変えると、他の Pass も同じプロバイダーのモデルに自動で揃います
  - **Pass5（長行改行）**: 長い行だけ改行する後処理（必要ならモデルを選択。プロバイダーは自動判定）
  - **開始遅延(秒)**: テロップの表示タイミングを調整したい場合に入力します（デフォルト: `0.2`）。  
    `0` にすると無効です。例: `0.2` と入力すると、各テロップが 0.2 秒遅れて表示されます。  
    （Whisper の文字起こしが実際の発話より少し早いケースに有効です）
  - **ログ保存（詳細設定）**: ONにすると、保存先フォルダ内に `{入力ファイル名(拡張子なし)}_{timestamp}/` が作られ、その中に `.srt` と `logs/` が保存されます（トラブル時に開発者へ渡す用）。

### 4-2. 実際の操作手順

1. **音声/動画ファイルを選択**  
   「スロット 1」の **「ファイルを選択」** ボタンを押し、
   対象の音声/動画ファイル（wav / mp3 / mp4 など）を選びます。

2. **保存先フォルダを確認・変更**  
   必要に応じて **「保存先を変更」** ボタンから、ファイルを保存したいフォルダを選びます。

3. **設定を確認**  
   必要なら「詳細設定」で Pass のモデルを変更します（通常はそのままでOKです）。  
   ※利用するプロバイダーは、選んだモデルから自動で判定されます（例: `gpt-*` を選ぶと OpenAI）。

4. **文字起こしを実行**  
   **「実行」** ボタンを押すと、音声 → テキスト変換が開始されます。  
   進行状況や完了メッセージは、それぞれの「ステータス」欄に表示されます。

5. **結果を確認**  
   処理完了後、保存先フォルダに `.srt` が生成されます。  
   ※ログ保存ONの場合は、保存先フォルダ内に `{入力ファイル名(拡張子なし)}_{timestamp}/` が作られ、その中に `.srt` と `logs/` が生成されます。  
   動画編集ソフトに読み込んで字幕として利用できます。
   画面下部に、処理時間・トークン数・概算コストが表示されます。

---

## 5. よくあるポイント / トラブルシューティング

- **インターネット接続が必要な場合があります**  
  LLM 整形（Google / OpenAI / Anthropic）を使う場合はオンライン環境で使用してください。

- **API キーを変更したい場合**  
  もう一度 **「API設定」** ボタンを押し、新しいキーを入力して「保存」してください。

- **アプリが起動できない場合**  
  - 再度、`FlowCut.app` を **右クリック →「開く」** から起動してみてください。
  - それでも難しい場合は、開発者にスクリーンショットを送って相談してください。

### Windows: 「起動できない / dll が見つからない」場合

Windows 環境によっては、初回起動時に
「`VCRUNTIME140.dll` が見つからない」などのエラーが出て起動できないことがあります。  
その場合は **Microsoft Visual C++ ランタイム（再頒布可能パッケージ）** を入れると解決することが多いです。

手順（ターミナルから実行する場合）
1. PowerShell（または Windows ターミナル）を開く
2. 次を実行してインストールする（x64）
   - `winget install --id Microsoft.VCRedist.2015+.x64`
3. もう一度 `FlowCut.exe` を起動する

手順（ブラウザからダウンロードして入れる場合）
1. 次の Microsoft 公式ページを開く

   ```
   https://learn.microsoft.com/en-us/cpp/windows/latest-supported-vc-redist?view=msvc-170
   ```

2. 「Visual C++ Redistributable v14」の **X64** をダウンロードして実行する
   - 直接リンク（X64）:

   ```
   https://aka.ms/vc14/vc_redist.x64.exe
   ```

3. インストール後、もう一度 `FlowCut.exe` を起動する

※ 2026/01/24 以降の Windows 版では、安定性のため Visual C++ ランタイムを OS 側のものに任せています。  
そのため、上記の VC++ ランタイムが未導入だと起動できない場合があります。

※ うまくいかない場合は、エラーメッセージの画面を開発者に送ってください（dll 名が分かるとすぐ特定できます）。

---

## 6. 補足情報

- FlowCut は、1 台の Mac 上でローカルに動作します。  
  音声ファイルや生成された字幕ファイルは、あなたの Mac の中にのみ保存されます。
- LLM 整形を使う場合、文字起こしテキスト（字幕の元になる文章）がクラウド API に送信されます。
- アプリの挙動や変換精度は、各 LLM API の仕様変更などにより変わる可能性があります。
